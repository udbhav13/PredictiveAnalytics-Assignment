---
title: "Question 1"
author: "Shivank Sood"
date: "8/18/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
library(tidyverse)
library(ggplot2)
#setwd("C:\\Users\\shiva\\Documents\\James Scott - Predictive #R\\STA380-master\\STA380-master\\data")
g_build = read.csv("https://raw.githubusercontent.com/jgscott/STA380/master/data/greenbuildings.csv")
head(g_build)
dim(g_build)



g_build$cluster= as.factor(g_build$cluster)
g_build$green_rating = as.factor(g_build$green_rating)
g_build$CS_PropertyID = as.factor(g_build$CS_PropertyID)
g_build$amenities= as.factor(g_build$amenities)
g_build$net = as.factor(g_build$net)
g_build$class_a = as.factor(g_build$class_a)
g_build$class_b = as.factor(g_build$class_b)
g_build$renovated = as.factor(g_build$renovated)
g_build$LEED = as.factor(g_build$LEED)
g_build$Energystar = as.factor(g_build$Energystar)

```
I disagree with the on-staff stats guru on some points mentioned below:  
Which Cluster is the location in:  
The excel guru looks at the rent of the whole market and fails to consider cluster in the whole economic calculation. Each cluster has a different rent spectrum. Moreover, the green building in each cluster has a different trend of market rate as compared to the non-green buildings in the same cluster. In some clusters, green buildings are less expensive than the others and in others the difference is very different from others. So $2.6 more per squarefoot is a vague estimate. It can easily be more or less depending on the cluster.
```{r echo=FALSE}
Clusters = g_build %>% group_by(green_rating,cluster) %>% summarise(med_rent = median(Rent))
ggplot(Clusters, aes(x=reorder(cluster,med_rent), y=med_rent, color = green_rating)) + geom_point()+
  scale_y_log10()+labs(title="Plot of cluster-wise green and non-green property rents",x ="Clusters", y = "Rent",color="Green Building")+
   theme(axis.text.x=element_blank())
```
Can we assume minimum occupancy rate of 90%?  
Half of the properties have below 90% occupancy rate. Though green properties are more occupied than non-green but still 90% is a very large assumption on part of the stats-guru. Moreover, some clusters don't have that much occupancy, which can mean that there is not much demand in those clusters ruling out the idea of investing in those clusters. 
```{r echo=FALSE}
summary(g_build$leasing_rate)
ggplot(g_build, aes(x=green_rating, y=leasing_rate)) + geom_boxplot() 
avg_lr  = g_build %>% group_by(cluster,green_rating) %>% summarise(avg_lr = mean(leasing_rate)) %>% arrange(desc(avg_lr))
ggplot(avg_lr, aes(x=reorder(cluster,avg_lr), y=avg_lr,color=green_rating)) + geom_point() + geom_hline(yintercept = 90)+
  labs(title="Plot of cluster-wise green and non-green building occupancy",x ="Clusters", y = "Average Occupancy", color="Green Building")+
   theme(axis.text.x=element_blank())
```
Who pays the utility bills?  
The stats-guru does not take into account whether the utility bills are paid by renter or not. Rents are obviously higher for utility cost included in rent. There seem to be both green and non-green buildings in the two categories. We need to account for utility charges if either case is there.
```{r echo=FALSE}
ggplot(g_build, aes(x=net, y=Rent, colour = green_rating)) + geom_boxplot() +scale_y_log10()+
  labs(title="Boxplot for Variation of rent with Utility cost contract ",x ="Utility Cost status", y = "Rent",color="Green Building")

```
Electricity cost and Gas costs  
Both Electricity and Gas costs are different for different clusters. 
```{r echo=FALSE}
Electricity = g_build %>% group_by(cluster) %>% summarise(avg = mean(Electricity_Costs))
ggplot(Electricity, aes(x=reorder(cluster,avg), y=avg)) + geom_point()+
  labs(title="Cluster-wise Electricity Costs",x ="Clusters", y = "Electricity Costs")+
   theme(axis.text.x=element_blank())
```

```{r echo=FALSE}
Gas = g_build %>% group_by(cluster) %>% summarise(avg = mean(Gas_Costs))
ggplot(Gas, aes(x=reorder(cluster,avg), y=avg)) + geom_point()+
  labs(title="Cluster-wise Gas Costs",x ="Clusters", y = "Gas Costs") +
   theme(axis.text.x=element_blank())
```
Do all clusters have equally tall buildings?  
Each cluster has a different range of stories of a building. As a trend, green buildings are usually taller cluster-wise. The trend in the story reflects the demand in the area and there also might be additional legal restrictions in some areas as well.
```{r echo=FALSE}
stor = g_build %>% group_by(cluster,green_rating) %>% summarise(strs = median(stories))
ggplot(stor, aes(x=reorder(cluster,strs), y=strs,color = green_rating)) + geom_point() + geom_hline(yintercept = 15)+
  labs(title="Cluster-wise Stories distribution",x ="Clusters", y = "Median Stories",color="Green Building")+
   theme(axis.text.x=element_blank())
```
CONCLUSION  
-The recommendation put forward by the stats guru seems pretty vague and incomplete. He fails to consider factors which might have an economic impact both positively and negatively.   
-He did not consider the cluster-wise distribution of rents and then the difference of green and non-green property's rent.      
-His assumption of atleast 90% occupancy seems vague.    
-He does not account utility costs nor does he consider whether it is included in the rent or not.    
-All clusters do not have high sky scrapers. One hypothesis is that it can indicate demand or legal restrictions.  